<div class="oa-overview-container">
  <div class="oa-overview-header">
    <h2>{{t "dashboard_title"}}</h2>
    <div class="oa-widgets-filter">
      <button id="oa-widgets-filter-button" class="oa-widgets-filter-button" title="{{t 'filter_widgets_tooltip'}}">
        <span class="oa-filter-icon">‚öôÔ∏è</span> {{t "filter_widgets"}}
      </button>
    </div>
  </div>

  <!-- Panel de filtros (inicialmente oculto) -->
  <div id="oa-widgets-filter-panel" class="oa-widgets-filter-panel oa-hidden">
    <div class="oa-filter-header">
      <h3>{{t "select_widgets"}}</h3>
      <button id="oa-close-filter-panel" class="oa-close-filter-button">√ó</button>
    </div>
    <div class="oa-widget-checkboxes">
      <label><input type="checkbox" data-widget="total-tasks" checked> {{t "total_tasks"}}</label>
      <label><input type="checkbox" data-widget="completed-tasks" checked> {{t "completed_tasks"}}</label>
      <label><input type="checkbox" data-widget="pending-tasks" checked> {{t "pending_tasks"}}</label>
      <label><input type="checkbox" data-widget="in-progress-tasks" checked> {{t "in_progress_tasks"}}</label>
      <label><input type="checkbox" data-widget="productivity" checked> {{t "productivity"}}</label>
      <label><input type="checkbox" data-widget="high-priority" checked> {{t "high_priority_w"}}</label>
      <!--<label><input type="checkbox" data-widget="estimated-time" checked> {{t "estimated_time"}}</label>-->
      <label><input type="checkbox" data-widget="no-date-tasks" checked> {{t "no_date_tasks"}}</label>
      <label><input type="checkbox" data-widget="completed-this-week" checked> {{t "completed_this_week"}}</label>
      <!--<label><input type="checkbox" data-widget="completion-trend" checked> {{t "completion_trend"}}</label>-->
      <label><input type="checkbox" data-widget="completion-ratio" checked> {{t "completion_ratio"}}</label>
      <label><input type="checkbox" data-widget="consistency" checked> {{t "consistency"}}</label>
      <label><input type="checkbox" data-widget="system-health" checked> {{t "system_health"}}</label>
      <label><input type="checkbox" data-widget="today-tasks" checked> {{t "today_tasks"}}</label>
      <label><input type="checkbox" data-widget="overdue-tasks" checked> {{t "overdue_tasks"}}</label>
      <label><input type="checkbox" data-widget="upcoming-tasks" checked> {{t "upcoming_tasks"}}</label>
      <label><input type="checkbox" data-widget="invalid-tasks" checked> {{t "invalid_tasks"}}</label>
      <label><input type="checkbox" data-widget="oldest-tasks" checked> {{t "oldest_tasks"}}</label>
      <label><input type="checkbox" data-widget="project-tasks" checked> {{t "project_tasks"}}</label>
    </div>
    <div class="oa-filter-actions">
      <button id="oa-apply-widget-filters" class="oa-apply-filter-button">{{t "apply"}}</button>
      <button id="oa-reset-widget-filters" class="oa-reset-filter-button">{{t "reset"}}</button>
    </div>
  </div>
  <!-- Widget de estad√≠sticas -->
  <div class="oa-stats-widgets">
    <div class="oa-stat-card" data-widget-type="total-tasks" title="{{t 'total_tasks_tooltip'}}">
      <h3>{{t "total_tasks"}}</h3>
      <div class="oa-stat-content">
        <span class="oa-stat-number">{{totalTasks}}</span>
        <div class="oa-stat-icon">üìã</div>
      </div>
    </div>

    <div class="oa-stat-card" data-widget-type="completed-tasks" title="{{t 'completed_tasks_tooltip'}}">
      <h3>{{t "completed_tasks"}}</h3>
      <div class="oa-stat-content">
        <span class="oa-stat-number">{{completedTasks}}</span>
        <div class="oa-stat-icon">‚úÖ</div>
      </div>
    </div>

    <div class="oa-stat-card" data-widget-type="pending-tasks" title="{{t 'pending_tasks_tooltip'}}">
      <h3>{{t "pending_tasks"}}</h3>
      <div class="oa-stat-content">
        <span class="oa-stat-number">{{pendingTasks}}</span>
        <div class="oa-stat-icon">‚≠ï</div>
      </div>
    </div>

    <div class="oa-stat-card" data-widget-type="in-progress-tasks" title="{{t 'in_progress_tasks_tooltip'}}">
      <h3>{{t "in_progress_tasks"}}</h3>
      <div class="oa-stat-content">
        <span class="oa-stat-number">{{inProgressTasks}}</span>
        <div class="oa-stat-icon">üõ†Ô∏è</div>
      </div>
    </div>

    <div class="oa-stat-card" data-widget-type="productivity" title="{{t 'productivity_tooltip'}}">
      <h3>{{t "productivity"}}</h3>
      <div class="oa-stat-content">
        <span class="oa-stat-number">{{productivity}}%</span>
        <div class="oa-stat-icon">üìä</div>
      </div>
    </div>

    <div class="oa-stat-card" data-widget-type="high-priority" title="{{t 'high_priority_tooltip'}}">
      <h3>{{t "high_priority_w"}}</h3>
      <div class="oa-stat-content">
        <span class="oa-stat-number">{{highPriorityTasks}}</span>
        <div class="oa-stat-icon">üî∫</div>
      </div>
    </div>

    <!--<div class="oa-stat-card" data-widget-type="estimated-time" title="{{t 'estimated_time_tooltip'}}">
      <h3>{{t "estimated_time"}}</h3>
      <div class="oa-stat-content">
        <span class="oa-stat-number">{{totalEstimatedTime}}</span>
        <div class="oa-stat-icon">‚è±Ô∏è</div>
      </div>
    </div>-->
    
    <!-- Nuevos widgets -->
    <div class="oa-stat-card" data-widget-type="no-date-tasks" title="{{t 'no_date_tasks_tooltip'}}">
      <h3>{{t "no_date_tasks"}}</h3>
      <div class="oa-stat-content">
        <span class="oa-stat-number">{{noDateTasks}}</span>
        <div class="oa-stat-icon">üìÖ</div>
      </div>
    </div>

    <div class="oa-stat-card" data-widget-type="completed-this-week" title="{{t 'completed_this_week_tooltip'}}">
      <h3>{{t "completed_this_week"}}</h3>
      <div class="oa-stat-content">
        <span class="oa-stat-number">{{completedThisWeek}}</span>
        <div class="oa-stat-icon">üóìÔ∏è</div>
      </div>
    </div>

    <!--<div class="stat-card completion-trend" title="{{t 'completion_trend_tooltip'}}">
      <h3>{{t "completion_trend"}}</h3>
      <div class="oa-stat-content">
        <span class="oa-stat-number">{{completionTrend}}</span>
        <div class="oa-stat-icon">üìà</div>
      </div>
    </div>-->

    <div class="oa-stat-card" data-widget-type="completion-ratio" title="{{t 'completion_ratio_tooltip'}}">
      <h3>{{t "completion_ratio"}}</h3>
      <div class="oa-stat-content">
        <span class="oa-stat-number">{{completionRatio}}</span>
        <div class="oa-stat-icon">üìÜ</div>
      </div>
    </div>

    <div class="oa-stat-card" data-widget-type="consistency" title="{{t 'consistency_tooltip'}}">
      <h3>{{t "consistency"}}</h3>
      <div class="oa-stat-content">
        <span class="oa-stat-number">{{consistency}}%</span>
        <div class="oa-stat-icon">üîÑ</div>
      </div>
    </div>

    <div class="oa-stat-card" data-widget-type="system-health" title="{{t 'system_health_tooltip'}}">
      <h3>{{t "system_health"}}</h3>
      <div class="oa-stat-content">
        <span class="oa-stat-number">{{systemHealth}}%</span>
        <div class="oa-stat-icon">‚ù§Ô∏è</div>
      </div>
    </div>
  </div>

  <!-- Widgets de listas de tareas -->
  <div class="oa-task-widgets-container">
    <!-- Tareas para hoy -->
    <div class="oa-task-widget" data-widget-type="today-tasks" title="{{t 'today_tasks_tooltip'}}">

      <div class="oa-task-widget-header">
        <h3>{{t "today_tasks"}}</h3>
        <div class="oa-task-widget-icon">üìÖ</div>
      </div>
      <div class="oa-task-list-content">
        {{#if todayTasks.length}}
          <ul class="oa-task-list">
            {{#each todayTasks}}
              <li class="oa-task-item {{#if this.completed}}completed{{/if}}" data-file-path="{{this.file.path}}" data-line-number="{{this.line.number}}">
                <div class="oa-task-details">
                  <span class="oa-task-text">{{priorityIcon this.state.priority}} {{this.section.desc}}</span>
                </div>
              </li>
            {{/each}}
          </ul>
        {{else}}
          <div class="oa-empty-list">{{t "no_today_tasks"}}</div>
        {{/if}}
      </div>
    </div>

    <!-- Tareas vencidas -->
    <div class="oa-task-widget" data-widget-type="overdue-tasks" title="{{t 'overdue_tasks_tooltip'}}">
      <div class="oa-task-widget-header">
        <h3>{{t "overdue_tasks"}}</h3>
        <div class="oa-task-widget-icon">‚ö†Ô∏è</div>
      </div>
      <div class="oa-task-list-content">
        {{#if overdueTasks.length}}
          <ul class="oa-task-list">
            {{#each overdueTasks}}
              <li class="oa-task-item {{#if this.completed}}completed{{/if}}" data-file-path="{{this.file.path}}" data-line-number="{{this.line.number}}">
                <div class="oa-task-details">
                  <span class="oa-task-text">{{this.section.desc}}</span>
                  <span class="oa-task-due overdue">{{formatDate this.date.due}}</span>
                </div>
              </li>
            {{/each}}
          </ul>
        {{else}}
          <div class="oa-empty-list">{{t "no_overdue_tasks"}}</div>
        {{/if}}
      </div>
    </div>

    <!-- Tareas pr√≥ximas a vencer -->
    <div class="oa-task-widget" data-widget-type="upcoming-tasks" title="{{t 'upcoming_tasks_tooltip'}}">
      <div class="oa-task-widget-header">
        <h3>{{t "upcoming_tasks"}}</h3>
        <div class="oa-task-widget-icon">üîú</div>
      </div>
      <div class="oa-task-list-content">
        {{#if upcomingTasks.length}}
          <ul class="oa-task-list">
            {{#each upcomingTasks}}
              <li class="oa-task-item {{#if this.completed}}completed{{/if}}" data-file-path="{{this.file.path}}" data-line-number="{{this.line.number}}">
                <div class="oa-task-details">
                  <span class="oa-task-text">{{this.section.desc}}</span>                  
                  <span class="oa-task-due">{{formatDate this.date.due}}</span>
                </div>
              </li>
            {{/each}}
          </ul>
        {{else}}
          <div class="oa-empty-list">{{t "no_upcoming_tasks"}}</div>
        {{/if}}
      </div>
    </div>

    <!-- Widget de tareas no v√°lidas -->
    <div class="oa-task-widget" data-widget-type="invalid-tasks" title="{{t 'invalid_tasks_tooltip'}}">
      <div class="oa-task-widget-header">
        <h3>{{t "invalid_tasks"}}</h3>
        <div class="oa-task-widget-icon">‚ö†Ô∏è</div>
      </div>
      <div class="oa-task-list-content">
        {{#if invalidTasks.length}}
          <ul class="oa-task-list">
            {{#each invalidTasks}}
              <li class="oa-task-item clickable" data-file-path="{{this.file.path}}" data-line-number="{{this.line.number}}">
                <div class="oa-task-details">
                  <span class="oa-task-text">{{priorityIcon this.state.priority}} {{this.section.desc}}</span>
                  <div class="oa-task-error-container">
                    {{#each this.errorMessages}}
                      <span class="oa-task-error">{{this}}</span>
                    {{/each}}
                  </div>
                </div>
              </li>
            {{/each}}
          </ul>
        {{else}}
          <div class="oa-empty-list">{{t "no_invalid_tasks"}}</div>
        {{/if}}
      </div>
    </div>

    <!-- Widget de tareas m√°s antiguas -->
    <div class="oa-task-widget" data-widget-type="oldest-tasks" title="{{t 'oldest_tasks_tooltip'}}">
      <div class="oa-task-widget-header">
        <h3>{{t "oldest_tasks"}}</h3>
        <div class="oa-task-widget-icon">‚è≥</div>
      </div>
      <div class="oa-task-list-content">
        {{#if oldestTasks.length}}
          <ul class="oa-task-list">
            {{#each oldestTasks}}
              <li class="oa-task-item clickable" data-file-path="{{this.file.path}}" data-line-number="{{this.line.number}}">
                <div class="oa-task-details">
                  <span class="oa-task-text">{{priorityIcon this.state.priority}} {{this.section.desc}}</span>
                  <span class="oa-task-age">{{this.daysOld}} {{t "days_old"}}</span>
                </div>
              </li>
            {{/each}}
          </ul>
        {{else}}
          <div class="oa-empty-list">{{t "no_old_tasks"}}</div>
        {{/if}}
      </div>
    </div>

    <!-- Widget de tareas por proyecto -->
    <div class="oa-task-widget" data-widget-type="project-tasks" title="{{t 'project_tasks_tooltip'}}">
      <div class="oa-task-widget-header">
        <h3>{{t "project_tasks"}}</h3>
        <div class="oa-task-widget-icon">üìÅ</div>
      </div>
      <div class="oa-task-list-content">
        {{#if projectTasks.length}}
          {{#each projectTasks}}
            <div class="oa-project-group">
              <h4 class="oa-project-name">{{this.project}} ({{this.tasks.length}})</h4>
              <ul class="oa-task-list">
                {{#each this.tasks}}
                  <li class="oa-task-item clickable" data-file-path="{{this.file.path}}" data-line-number="{{this.line.number}}">
                    <div class="oa-task-details">
                      <span class="oa-task-text">{{priorityIcon this.state.priority}} {{this.section.desc}}</span>
                    </div>
                  </li>
                {{/each}}
              </ul>
            </div>
          {{/each}}
        {{else}}
          <div class="oa-empty-list">{{t "no_project_tasks"}}</div>
        {{/if}}
      </div>
    </div>

  </div>
</div>

